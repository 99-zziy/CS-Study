# 쿠키 세션 로컬스토리지 세션스토리지

1. 쿠키 VS 웹스토리지 비교
2. 쿠키 VS 세션 비교

## 1. 쿠키 vs 웹스토리지 

### 쿠키란?
- http는 비연결성, 무상태성 특징이 있기때문에 해결하기 위해 쿠키가 나옴
- 브라우저에 저장되는 작은 크기의 문자열 (최대 4KB)

#### Cookies 2가지 유형
- persistent cookies : 만료일을 포함하지 않고, 브라우저나 탭이 열려있는 동안에만 저장됩니다.
- session cookies :  만료일까지 유저의 디스크에 저장되고 만료일이 지나면 삭제됩니다.

#### 문제점? 
- CSRF 
- XSS
- 부족한 저장용량
- HTTP 요청시 자동으로 모든 쿠키를 전송
 
> CSRF 란?  
> 웹 어플리케이션 취약점 중 하나로 인터넷 사용자(희생자)가 자신의 의지와는 무관하게 공격자가 의도한 행위(수정, 삭제, 등록 등)를 특정 웹사이트에 요청하게 만드는 공격  
> 정상적인 request를 가로채 피해자인 척 하고 백엔드 서버에변조된 request를 보내 악의적인 동작을 수행하는 공격을 의미. (피해자 정보 수정, 정보 열람)

> XSS 란? 
> 공격자가 의도하는 악의적인 js 코드를 피해자 웹 브라우저에서 실행시키는 것  

### 웹스토리지란?
- 최대 5MB -> 쿠키의 부족한 저장용량 해결 
- 요청시 Headers에 전송하지않음 -> 쿠키의 CSRF, 트래픽 문제 해결
- 객체 정보 저장이 가능

||로컬 스토리지|세션 스토리지|
|---|---|---|
|저장범위|도메인/브라우저|도메인/브라우저/탭|
|삭제시기|직접 삭제|탭 종료시|
 

#### 문제점?
- 웹 스토리지 비활성화 설정 (시크릿 모드), 에러 처리 해야함
- HTML5를 지원하지 않는 브라우저의 경우 사용 불가
- XSS
- 만료기간 설정 불가
- 동기적으로 실행 -> 메인스레드를 블로킹함 => 용량이 크면 주의 ‼️ (IndexedDB 사용)

### 쿠키 & 웹스토리지 정리

=> 보안 문제가 있기 때문에 민감한 정보는 저장 x

- **쿠키** (기간 설정, 서버전송 해야하기 때문에 작은 용량)
ex) n일 동안 보지않기, 비로그인 장바구니

- **세션 스토리지** (탭 종료시 삭제되어도 괜찮은것)
ex) 이전 페이지 저장, 이전 스크롤 위치 저장

- **로컬 스토리지** (브라우저 종료시 유지)
ex ) 글 임시저장, 사용자 설정 저장 , 자동로그인 

사실 정해진 답은 없다, 예를 들면 ? 비로그인 장바구니를 쿠키에 넣어야한다는 사람도 있고, 세션스토리지에 넣어야한다는 사람도 있다.
나도 비로그인 장바구니는 장바구니에 많은 양을 담을 수도 없고, 서버 요청시 계속 전송이 된다는 점에서 세션스토리지에 넣어야한다고 생각했는데, 몇개의 쇼핑몰을 살펴보니 (쿠팡도..!) 탭이 삭제되어있어도 장바구니에 담겨져있는것을 확인했다.  
아마도 쿠키를 사용한것 같다..! 왜 쿠키에 넣었을까를 생각해보면, 사용자들이 소비를 더 이끌수 있지 않나싶다... 아무래도 계속 넣어져있으니까?

저번에 JWT 공부를 했을때 토큰을 어디에 저장해야할지 궁금했었다.  
이번에 공부한 것과 + [이글을 참고](https://velog.io/@0307kwon/JWT%EB%8A%94-%EC%96%B4%EB%94%94%EC%97%90-%EC%A0%80%EC%9E%A5%ED%95%B4%EC%95%BC%ED%95%A0%EA%B9%8C-localStorage-vs-cookie )해서 정리해본결과.. 는 XSS, CSRF를 잘몰라서 이것 보고 난 후에 다시 생각해보자!!


## 2. 쿠키 vs 세션





